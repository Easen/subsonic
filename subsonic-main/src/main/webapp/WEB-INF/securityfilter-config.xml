<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE securityfilter-config PUBLIC
        "-//SecurityFilter.org//DTD Security Filter Configuration 2.0//EN"
        "http://www.securityfilter.org/dtd/securityfilter-config_2_0.dtd">

<securityfilter-config>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic</web-resource-name>
            <url-pattern>*.view</url-pattern>
            <url-pattern>*.jsp</url-pattern>
            <url-pattern>*.m3u</url-pattern>
            <url-pattern>/dwr</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>user</role-name>
        </auth-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic (admin)</web-resource-name>
            <url-pattern>/generalSettings.view</url-pattern>
            <url-pattern>/userSettings.view</url-pattern>
            <url-pattern>/musicFolderSettings.view</url-pattern>
            <url-pattern>/internetRadioSettings.view</url-pattern>
            <url-pattern>/searchSettings.view</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>admin</role-name>
        </auth-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic (download)</web-resource-name>
            <url-pattern>/download.view</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>download</role-name>
        </auth-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic (upload)</web-resource-name>
            <url-pattern>/upload.view</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>upload</role-name>
        </auth-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic (playlist)</web-resource-name>
            <url-pattern>/deletePlaylist.view</url-pattern>
            <url-pattern>/savePlaylist.view</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>playlist</role-name>
        </auth-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic (coverart)</web-resource-name>
            <url-pattern>/changeCoverArt.view</url-pattern>
            <url-pattern>/editTags.view</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>coverart</role-name>
        </auth-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Subsonic (comment)</web-resource-name>
            <url-pattern>/setMusicFileInfo.view</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>comment</role-name>
        </auth-constraint>
    </security-constraint>

    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name>Welcome to Subsonic!</realm-name>
    </login-config>

    <realm className="net.sourceforge.subsonic.filter.SecurityRealmFilter"/>

</securityfilter-config>